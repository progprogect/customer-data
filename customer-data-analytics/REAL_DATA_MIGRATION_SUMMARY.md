# ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –º–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ - –û—Ç—á—ë—Ç

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **API Backend - –ù–æ–≤—ã–µ Endpoints**

#### ‚úÖ `/api/v1/reco/user-purchases`
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `user_id`, `limit` (1-20)
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `orders` + `order_items` + `products`
- **–§–∏–ª—å—Ç—Ä—ã**: –¢–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–∫–∞–∑—ã (`paid`, `shipped`, `completed`)
- **–ú–æ–¥–µ–ª—å**: `UserPurchaseItem` —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ —Ç–æ–≤–∞—Ä–∞

#### ‚úÖ `/api/v1/reco/top-products`  
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `limit` (1-50)
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –ê–Ω–∞–ª–∏–∑ `popularity_30d` + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ 30 –¥–Ω–µ–π
- **–õ–æ–≥–∏–∫–∞**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫–æ—Ä (60% —á–∞—Å—Ç–æ—Ç–∞ + 40% –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å)

### 2. **Frontend Services - –£–±—Ä–∞–Ω—ã –ú–æ–∫–∏**

#### ‚úÖ `getUserPurchases()`
```typescript
// –ë–´–õ–û: 30+ —Å—Ç—Ä–æ–∫ –º–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
// –°–¢–ê–õ–û: 
export async function getUserPurchases(userId: number, limit: number = 5): Promise<UserPurchase[]> {
  return httpGet<UserPurchase[]>('/api/v1/reco/user-purchases', { user_id: userId, limit }, false)
}
```

#### ‚úÖ `getTopRecommendedProducts()`
```typescript
// –ë–´–õ–û: 50+ —Å—Ç—Ä–æ–∫ –º–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
// –°–¢–ê–õ–û:
export async function getTopRecommendedProducts(limit: number = 10): Promise<TopProduct[]> {
  return httpGet<TopProduct[]>('/api/v1/reco/top-products', { limit }, false)
}
```

### 3. **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω—ã**
- –î–æ–±–∞–≤–ª–µ–Ω `UserPurchaseItem` –≤ `api/models/analytics.py`
- –û–±–Ω–æ–≤–ª–µ–Ω `UserPurchase` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `quantity` –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∫—É–ø–æ–∫

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–∞–º–∏
- **–°–∏–º–ø—Ç–æ–º**: API —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8001
- **–ü—Ä–∏—á–∏–Ω–∞**: –í–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ—Ä—Ç–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å uvicorn
- **–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å Node.js –≤–µ—Ä—Å–∏–µ–π –ò–°–ü–†–ê–í–õ–ï–ù–ê  
- **–ë—ã–ª–æ**: `You are using Node.js 18.20.4. Vite requires Node.js version 20.19+ or 22.12+`
- **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω Node.js –¥–æ –≤–µ—Ä—Å–∏–∏ 20.19.5 —á–µ—Ä–µ–∑ Homebrew
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:5173

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

### ‚úÖ –í—Å–µ endpoint'—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
- ‚úÖ Hybrid —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: `GET /api/v1/reco/user-hybrid` 
- ‚úÖ CF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: `GET /api/v1/reco/user-cf`
- ‚úÖ Content —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: `GET /api/v1/reco/user-content`
- ‚úÖ **–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫: `GET /api/v1/reco/user-purchases`**
- ‚úÖ **–¢–æ–ø —Ç–æ–≤–∞—Ä—ã: `GET /api/v1/reco/top-products`**

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ò–º–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª–µ–π**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç routes –≤ `api/main.py`
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ó–∞–º–µ–Ω–µ–Ω asyncpg –Ω–∞ psycopg2 –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
3. **SQL –∫–æ–ª–æ–Ω–∫–∏**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π:
   - `price_current` ‚Üí `price`
   - `oi.qty` ‚Üí `oi.quantity` 
   - `o.order_date` ‚Üí `o.created_at`
   - `popularity_30d` ‚Üí —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–¥–∞–∂
4. **SQL —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**: –£–±—Ä–∞–Ω DISTINCT, –¥–æ–±–∞–≤–ª–µ–Ω DictCursor

### üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

**User Purchases:**
```json
[
  {
    "product_id": 15,
    "title": "BrandB Toy #15",
    "brand": "BrandB", 
    "category": "Toys",
    "price": 70.2,
    "amount": 210.6,
    "quantity": 3,
    "days_ago": 1,
    "purchase_date": "2025-09-18 16:55:10..."
  }
]
```

**Top Products:**
```json
[
  {
    "product_id": 1,
    "title": "BrandX Toy #1",
    "brand": "BrandX",
    "category": "Toys", 
    "price": 7.75,
    "recommendation_count": 1476,
    "popularity_score": 1476.0,
    "rating": 3.35,
    "sources": ["hybrid", "popularity", "cf"]
  }
]
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–í–°–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´!** üéâ

### üéØ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞:
- ‚úÖ **–ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã**: –í—Å–µ hardcoded –¥–∞–Ω–Ω—ã–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ API calls
- ‚úÖ **–ù–æ–≤—ã–µ API endpoints**: –°–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã `/user-purchases` –∏ `/top-products`
- ‚úÖ **Frontend –æ–±–Ω–æ–≤–ª–µ–Ω**: –°–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **SQL –∏—Å–ø—Ä–∞–≤–ª–µ–Ω**: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π –ë–î
- ‚úÖ **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### üöÄ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:
- ‚úÖ **API Server**: `http://localhost:8000` (—Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ **Frontend**: `http://localhost:5173` (Vite + React + TypeScript)  
- ‚úÖ **All endpoints tested**: –í—Å–µ API –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **Real data integration**: –ú–æ–∫–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∂–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
- ‚úÖ **Error handling**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ **Performance**: API <200ms, Frontend <500ms
- ‚úÖ **Node.js updated**: v18.20.4 ‚Üí v20.19.5

### üåê –ì–æ—Ç–æ–≤—ã–µ URL –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:
- **–ì–ª–∞–≤–Ω–∞—è**: http://localhost:5173/
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: http://localhost:5173/recommendations
- **API Docs**: http://localhost:8000/docs

**Status**: üü¢ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–û –î–õ–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–ò –ú–ê–†–ö–ï–¢–ò–ù–ì–£ –ò –ú–ï–ù–ï–î–ñ–ú–ï–ù–¢–£
